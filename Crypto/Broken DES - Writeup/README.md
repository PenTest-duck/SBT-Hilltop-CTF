# Broken DES - Writeup

This DES challenge requires a deep understanding of the inner-workings of the DES algorithm.
The solver must understand (step-by-step) how the DES key schedule works, and how DES decryption for a single block works.

This challenge gave a ciphertext which had only completed 5 out of the 16 rounds and k12 - or the 12th round key that was being used on the ciphertext in round 5 (DES decryption applies keys in reverse order) - and had the solver finish off the decryption, without knowledge of the initial key or ciphertext.

There were two major tasks the solver had to address:
  1. Generate round keys k1 to k11, by using k12.
  2. Finish the remaining 11 rounds of decryption.

# Generating the Round Keys

Before trying to modify the key schedule process to obtain round keys k1 to k11, the solver must understand how normal key scheduling works. A normal key scheduling process with an initial 64-bit key is the following:
  1. Permute the initial key according to the PC-1 table (key size 64 -> 56).
  2. Split the key into halves c0 and d0.
  3. Left shift c0 and d0 according to the LS scheme to obtain c1 to c16 and d1 to d16.
  4. Permute cNdN according to the PC-2 table to obtain the 16 subkeys (key size 56 -> 48).
  
The question now is: how can the key scheduling process be manipulated to generate k1 to k11 using k12?

Since c0 and d0 are shifted 16 times to eventually become 16 round keys, if the solver can obtain the value of c12, they can also generate the rest of the keys.

To obtain c12, k12 must be inverse permuted using a 'PC-2-1' table. 
This table can be manually generated by taking the existing PC-2 table, and writing the index of numbers starting from 1 to 56 (e.g. since 1 is at the 5th index in the PC-2 table, the number 5 is written in the 1st index in the PC-2-1 table). 
During this process, the solver should notice that bits 9, 18, 22, 25, 35, 38, 43 and 54 are missing.
This is normal behaviour as the PC-2 table reduces the key size from 56 bits to 48 bits by omitting some bits.
Since the solver does not know what those 8 bits were, the they must fill in those missing bits by brute forcing all 256 possibilities of c12.

For each possibility of c12, c12 should be inverse left shifted (or right shifted) according to the LS scheme to obtain c11 to c1 and d11 to d1. 
And for each of the 11 cNdN, it should be permuted according to the PC-2 table to result in 'potential round keys' k1 to k11.

# Finishing the Decryption
